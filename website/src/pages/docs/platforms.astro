---
import DocsLayout from '../../layouts/DocsLayout.astro'

const toc = [
  { label: 'Platform overview', anchor: 'overview' },
  { label: 'GitHub', anchor: 'github' },
  { label: 'GitLab', anchor: 'gitlab' },
  { label: 'Azure DevOps', anchor: 'azure' },
  { label: 'Bitbucket', anchor: 'bitbucket' },
  { label: 'Local mode', anchor: 'local' },
]
---

<DocsLayout title="Platform Support" toc={toc} icon={`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.75"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" /></svg>`}>
  <p>
    PR Review Kit supports all four major Git platforms. Platform CLI tools are optional — without them,
    the review runs locally using <code>git diff</code> and findings are saved as Markdown files.
  </p>

  <h2 id="overview">Platform overview</h2>
  <table>
    <thead>
      <tr>
        <th>Feature</th>
        <th>Local</th>
        <th>GitHub</th>
        <th>GitLab</th>
        <th>Azure DevOps</th>
        <th>Bitbucket</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Diff analysis</td>
        <td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td>
      </tr>
      <tr>
        <td>List open PRs</td>
        <td>—</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td>
      </tr>
      <tr>
        <td>Auto-detect base/head</td>
        <td>—</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td>
      </tr>
      <tr>
        <td>Post inline comments</td>
        <td>—</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td>
      </tr>
      <tr>
        <td>Approve / request changes</td>
        <td>—</td><td>✓</td><td>✓</td><td>✓</td><td>—</td>
      </tr>
    </tbody>
  </table>

  <h2 id="github">GitHub</h2>
  <p>Install and authenticate the GitHub CLI:</p>
  <pre><code># Install
brew install gh        # macOS
winget install GitHub.cli  # Windows

# Authenticate
gh auth login</code></pre>
  <p>
    Set <code>platform_repo</code> in config.yaml to <code>owner/repo</code> (e.g.
    <code>acme/my-service</code>).
  </p>

  <h2 id="gitlab">GitLab</h2>
  <p>Install and authenticate the GitLab CLI:</p>
  <pre><code># Install
brew install glab      # macOS
# See https://gitlab.com/gitlab-org/cli for other platforms

# Authenticate
glab auth login</code></pre>
  <p>Set <code>platform</code> to <code>gitlab</code> and <code>platform_repo</code> to <code>group/project</code>.</p>

  <h2 id="azure">Azure DevOps</h2>
  <p>Install the Azure CLI and add the DevOps extension:</p>
  <pre><code># Install Azure CLI
# See https://learn.microsoft.com/en-us/cli/azure/install-azure-cli

# Add DevOps extension
az extension add --name azure-devops

# Authenticate
az login</code></pre>
  <p>
    Set <code>platform</code> to <code>azure</code> and <code>platform_repo</code> to your project
    identifier. Diff loading falls back to <code>git diff</code> when the Azure CLI does not support
    it directly.
  </p>

  <h2 id="bitbucket">Bitbucket</h2>
  <p>
    Bitbucket support uses the <code>bb</code> CLI or <code>curl</code> with the Bitbucket REST API.
    Install the Bitbucket CLI or configure your API token for curl-based requests.
  </p>
  <p>Set <code>platform</code> to <code>bitbucket</code> and <code>platform_repo</code> to <code>workspace/repo-slug</code>.</p>

  <h2 id="local">Local mode</h2>
  <p>
    If you do not configure a <code>platform_repo</code>, or set <code>platform</code> to
    <code>none</code>, the review runs in local mode:
  </p>
  <ul>
    <li>Diff is generated via <code>git diff</code></li>
    <li>You select branches manually</li>
    <li>Findings are saved to <code>_prr-output/reviews/</code></li>
    <li>No inline comments are posted</li>
  </ul>
  <p>Local mode works with no platform account or CLI required.</p>
</DocsLayout>
