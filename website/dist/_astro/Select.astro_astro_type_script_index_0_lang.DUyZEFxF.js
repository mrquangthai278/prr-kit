import{d as M}from"./debounce.DT8DhbJn.js";import{o as w}from"./DOMUtils.xVoLgT47.js";import{l as z,d as b}from"./event.C5jlCmtE.js";const k=(r=!0)=>{const c=window.innerWidth-document.documentElement.clientWidth;r?(document.body.style.paddingRight=`${c}px`,document.body.style.overflow="hidden"):setTimeout(()=>{document.body.style.paddingRight="",document.body.style.overflow=""},300)},D=r=>{const{trigger:c,modal:l,onOpen:d,onClose:a}=typeof r=="string"?{}:r,m=typeof r=="string"?r:l,i=document.querySelector(c),t=document.querySelector(m);if(t instanceof HTMLElement){const n=t.dataset.close?.split(","),e=(o,h=!0)=>{t.dataset.show="true",h&&k(),d?.({trigger:i,modal:t})},p=(o,h=!0)=>{t.dataset.show="",h&&k(!1),a?.({trigger:i,modal:t})},f={icon(){const o=t.querySelector('[data-id="close"]');return{add:()=>o?.addEventListener("click",p),remove:()=>o?.removeEventListener("click",p)}},esc(){const o=h=>{t.dataset.show&&h.key==="Escape"&&p()};return{add:()=>document.addEventListener("keydown",o),remove:()=>document.removeEventListener("keydown",o)}},overlay(){const o=t.nextElementSibling;return{add:()=>o?.addEventListener("click",p),remove:()=>o?.removeEventListener("click",p)}}};return i?.addEventListener("click",e),n?.forEach(o=>{f[o]().add()}),{open(o){e(void 0,o)},close(){p()},replaceWith(o){o.open(!1),p(void 0,!1)},remove(){i?.removeEventListener("click",e),n?.forEach(o=>{f[o]().remove()})}}}},P=r=>{const c=document.querySelector(r);c instanceof HTMLElement&&(c.dataset.show="",k(!1))},Y=({trigger:r,popover:c,position:l,offset:d=10,closeOnBlur:a=!0,closeOnEsc:m=!0,onOpen:i,onClose:t})=>{const n=document.querySelector(r),e=document.querySelector(c);if(n&&e){document.body.appendChild(e),e.dataset.position=l.split("-")[0];const p=()=>{const s=n.getBoundingClientRect(),u=e.getBoundingClientRect(),v=s.top+window.scrollY-u.height-d,g=s.top+window.scrollY+s.height+d,y=s.left-u.width-d,E=s.left+s.width+d,L=s.left-(u.width-s.width)/2,O=s.left-(u.width-s.width),C=s.top+window.scrollY-(u.height-s.height)/2,q=s.top+window.scrollY,T=s.top+window.scrollY-(u.height-s.height),$={"top-start":{top:v,left:s.left},top:{top:v,left:L},"top-end":{top:v,left:O},"left-start":{top:q,left:y},left:{top:C,left:y},"left-end":{top:T,left:y},"right-start":{top:q,left:E},right:{top:C,left:E},"right-end":{top:T,left:E},"bottom-start":{top:g,left:s.left},bottom:{top:g,left:L},"bottom-end":{top:g,left:O}},{top:A,left:x}=$[l]||$.bottom;e.style.top=`${A}px`,e.style.left=`${x}px`,setTimeout(()=>{e.dataset.show=e.dataset.show==="true"?"":"true"},0),setTimeout(()=>{e.dataset.show||e.removeAttribute("data-show")},300),i?.({trigger:n,popover:e,position:l})},f=s=>{const u=s.target;!e.contains(u)&&!n.contains(u)&&e.dataset.show&&(e.dataset.show="",t?.({trigger:n,popover:e,position:l})),setTimeout(()=>{e.dataset.show||e.removeAttribute("data-show")},300)},o=s=>{s.key==="Escape"&&e.dataset.show&&(e.dataset.show="",t?.({trigger:n,popover:e,position:l}),setTimeout(()=>{e.removeAttribute("data-show")},300))},h=M(()=>{e.dataset.show="",setTimeout(()=>{e.dataset.show||e.removeAttribute("data-show")},300)}),S=new ResizeObserver(()=>{e.dataset.show&&h()});return n.addEventListener("click",p),S.observe(document.body),a&&document.addEventListener("click",f),m&&document.addEventListener("keydown",o),{remove(){n.removeEventListener("click",p),S.disconnect(),a&&document.removeEventListener("click",f),m&&document.removeEventListener("keydown",o)}}}},W=P,R=()=>{const r=document.querySelectorAll('[data-id^="w-select"]');let c=!1;w(document,"keydown",l=>{l.key==="Tab"&&(c=!0)}),w(document,"mousedown",()=>c=!1),Array.from(r).forEach(l=>{const d=l,a=d.dataset.id.split("w-select-")[1],m=d.dataset.position;if(m==="modal")D({trigger:`[data-id="${d.dataset.id}"]`,modal:`[data-id="w-options-${a}"]`,onOpen:({modal:i})=>{const t=i.querySelector("input");t&&t.focus()},onClose(i){b("selectOnClose",i)}});else{const i=M(()=>{const{width:t}=d.getBoundingClientRect(),n=document.querySelector(`[data-id="w-options-${a}"]`);n&&(n.style.width=`${t}px`)});new ResizeObserver(()=>i()).observe(document.body),Y({trigger:`[data-id="${d.dataset.id}"]`,popover:`[data-id="w-options-${a}"]`,position:m||"bottom",onOpen({popover:t}){const n=t.querySelector("input");n?n.focus():t.focus()},onClose(t){b("selectOnClose",t)}})}w(d,"focus",i=>{c&&i.currentTarget.click()})})};z("listOnSelect",r=>{const{name:c,list:l}=r,d=l.closest("dialog");if(!d)return;const a=d.dataset.id,m=a.split("w-options-")[1],i=`[data-id="w-select-${m}"]`,t=document.querySelector(i);W(`[data-id="${a}"]`),t.dataset.noUpdate||(t.value=c),b("selectOnChange",{...r,select:m})});w(document,"astro:after-swap",R);R();
